<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) Avanade. Licensed under the MIT License. See https://github.com/Avanade/Beef -->
<Template OutputGenDirName="Generated">
  <Table Condition="Table.EfModel == true" OutputFileName="{{Table.Name}}.cs" OutputDirName="EfModel">
    <Set Name="System.IsDeleted" Value="false" />
    <Set Name="System.OrgUnitId" Value="false" />
    <Set Name="System.MultiTenancy" Value="false"/>
    <Column>
      <If Condition="Column.Name == 'IsDeleted'">
        <Set Name="System.IsDeleted" Value="true" />
      </If>
      <If Condition="Column.Name == 'OrgUnitId'">
        <Set Name="System.OrgUnitId" Value="true" />
      </If>
      <If Condition="Column.Name == 'TenantId'">
        <Set Name="System.MultiTenancy" Value="true"/>
      </If>
    </Column>

    <Set Name="System.TableName" Value="Table.Name" />
    <If Condition="Table.View == true">
      <Set Name="System.TableName" Value="'vw{{Table.Name}}'" />
    </If>

    <![CDATA[/*
 * This file is automatically generated; any changes will be lost. 
 */

#nullable enable
#pragma warning disable IDE0005 // Using directive is unnecessary; are required depending on code-gen options
#pragma warning disable CA2227, CA1819 // Collection/Array properties should be read only; ignored, as acceptable for an EF Model.

using System;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Metadata.Builders;

namespace {{Config.Company}}.{{Config.AppName}}.Business.Data.EfModel
{
    /// <summary>
    /// Represents the Entity Framework (EF) model for database object '{{Table.Schema}}.{{System.TableName}}'.
    /// </summary>
    public partial class {{Table.Name}}
    {
]]>
    <Column Condition="Column.Name != 'IsDeleted' and Column.Name != 'TenantId'">
      <![CDATA[        /// <summary>
        /// Gets or sets the '{{Column.Name}}' column value.
        /// </summary>
]]>
      <If Condition="Column.Name:EndsWith('Url') == true">
        <![CDATA[        [System.Diagnostics.CodeAnalysis.SuppressMessage("Design", "CA1056:Uri properties should not be strings", Justification = "Named by design; OK for Model")]
]]>
      </If>
      <![CDATA[        public {{Column.DotNetType}}]]>
      <If Condition="Column.DotNetType == 'string' or Column.DotNetType == 'byte[]' or Column.IsNullable == true">
        <![CDATA[?]]>
      </If>
      <![CDATA[ {{Column.Name}} { get; set; }

]]>
    </Column>
    <![CDATA[        /// <summary>
        /// Adds the table/model configuration to the <see cref="ModelBuilder"/>.
        /// </summary>
        /// <param name="modelBuilder">The <see cref="ModelBuilder"/>.</param>
        public static void AddToModel(ModelBuilder modelBuilder)
        {
            if (modelBuilder == null)
                throw new ArgumentNullException(nameof(modelBuilder));

            modelBuilder.Entity<{{Table.Name}}>(entity =>
            {
                entity.ToTable("{{System.TableName}}", "{{Table.Schema}}");
                entity.HasKey(]]>
    <If Condition="Table.EfModelKey == null">
      <Then>
        <Column Condition="Column.IsPrimaryKey == true or Column.IsIdentity == true">
          <If Condition="System.Index > 0">
            <![CDATA[, ]]>
          </If>
          <![CDATA["{{Column.Name}}"]]>
        </Column>
      </Then>
      <Else><![CDATA[{{Table.EfModelKey}}]]></Else>
    </If>
    <![CDATA[);
]]>
    <Column>
      <![CDATA[                entity.Property(p => p.{{Column.Name}}).HasColumnType("{{Column.Type:ToUpperCase}}]]>
      <If Condition="Column.Type == 'nvarchar' or Column.Type == 'varchar' or Column.Type == 'nchar' or Column.Type == 'char'">
        <If Condition="Column.Length > 0">
          <Then><![CDATA[({{Column.Length}})]]></Then>
          <Else><![CDATA[(MAX)]]></Else>
        </If>
      </If>
      <If Condition="Column.Type == 'decimal' or Column.Type == 'numeric'">
        <![CDATA[({{Column.Precision}}, {{Column.Scale}})]]>
      </If>
      <If Condition="Column.Type == 'time'">
        <If Condition="Column.Scale > 0">
          <Then><![CDATA[({{Column.Scale}})]]></Then>
        </If>
      </If>
      <![CDATA[")]]>
      <If Condition="Column.IsComputed">
        <![CDATA[.ValueGeneratedOnAddOrUpdate()]]>
      </If>
      <If Condition="Column.Name == 'RowVersion'">
        <![CDATA[.IsRowVersion()]]>
      </If>
      <If Condition="Column.Name == 'CreatedBy'">
        <![CDATA[.ValueGeneratedOnUpdate()]]>
      </If>
      <If Condition="Column.Name == 'CreatedDate'">
        <![CDATA[.ValueGeneratedOnUpdate()]]>
      </If>
      <If Condition="Column.Name == 'UpdatedBy'">
        <![CDATA[.ValueGeneratedOnAdd()]]>
      </If>
      <If Condition="Column.Name == 'UpdatedDate'">
        <![CDATA[.ValueGeneratedOnAdd()]]>
      </If>
      <![CDATA[;
]]>
    </Column>
    <![CDATA[                AddToModel(entity);
            });
        }
        
        /// <summary>
        /// Enables further configuration of the underlying <see cref="EntityTypeBuilder"/> when configuring the <see cref="ModelBuilder"/>.
        /// </summary>
        static partial void AddToModel(EntityTypeBuilder<{{Table.Name}}> entity);
    }
}

#pragma warning restore CA2227, CA1819
#pragma warning restore IDE0005
#nullable restore]]>
  </Table>
</Template>