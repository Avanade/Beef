{{! Copyright (c) Avanade. Licensed under the MIT License. See https://github.com/Avanade/Beef }}
/*
 * This file is automatically generated; any changes will be lost. 
 */

#nullable enable
#pragma warning disable

{{! ===== Using ===== }}
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Diagnostics;
using System.Diagnostics.CodeAnalysis;
{{#ifeq JsonSerializer 'SystemText'}}
using System.Text;
{{/ifeq}}
using CoreEx.Entities;
using CoreEx.Entities.Extended;
using CoreEx.RefData;
{{#ifeq JsonSerializer 'Newtonsoft'}}
using Newtonsoft.Json;
{{/ifeq}}
{{#if Root.UsingNamespace1}}
using {{Root.UsingNamespace1}};
{{/if}}
{{#if Root.UsingNamespace2}}
using {{Root.UsingNamespace2}};
{{/if}}
{{#if Root.UsingNamespace3}}
using {{Root.UsingNamespace3}};
{{/if}}
{{#ifeq EntityUsing 'Common' 'All'}}
  {{#ifeq EntityScope 'Business'}}
using {{Root.NamespaceCommon}}.Entities;
  {{/ifeq}}
{{/ifeq}}
{{#ifval Root.RefDataNamespace}}
using RefDataNamespace = {{Root.RefDataNamespace}};
{{/ifval}}
{{#ifval Root.RefDataBusNamespace}}
using RefDataBusNamespace = {{Root.RefDataBusNamespace}};
{{/ifval}}

{{! ===== Class ===== }}
namespace {{#ifeq Root.RuntimeEntityScope 'Common'}}{{Root.NamespaceCommon}}{{else}}{{Root.NamespaceBusiness}}{{/ifeq}}.Entities{{#ifval Namespace}}.{{Namespace}}{{/ifval}}
{
    /// <summary>
    /// Represents the {{{Text}}} entity.
    /// </summary>
    public {{#if Abstract}}abstract {{/if}}partial class {{{EntityName}}} : {{{EntityInherits}}}{{#ifval EntityImplements}}, {{{EntityImplements}}}{{/ifval}}
    {
{{! ===== Constants ===== }}
{{#each Consts}}
        /// <summary>
        /// {{{SummaryText}}}
        /// </summary>
        public const {{Parent.ConstType}} {{Name}} = {{{FormattedValue}}};
  {{#if @last}}

  {{/if}}
{{/each}}
{{! ===== Privates ===== }}
{{#each PrivateProperties}}
        private {{{PrivateType}}} {{PropertyPrivateName}}{{#ifval Default}} = {{Default}}{{/ifval}};
  {{#ifval RefDataType}}
    {{#unless RefDataList}}
      {{#if RefDataText}}
        private string? {{PrivateName}}Text;
      {{/if}}
    {{/unless}}
  {{/ifval}}
{{/each}}
{{! ===== Properties ===== }}
{{#each CoreProperties}}
  {{#ifval RefDataType}}

        /// <summary>
        /// {{{SummaryRefDataSid}}}
        /// </summary>
    {{#if SerializationIgnore}}
        [JsonIgnore]
    {{else}}
      {{#ifval JsonName}}
        {{#ifeq Root.JsonSerializer 'Newtonsoft'}}
        [JsonProperty("{{JsonName}}")]
        {{else}}
        [JsonPropertyName("{{JsonName}}")]
        {{/ifeq}}
      {{/ifval}}
    {{/if}}
    {{#ifval DisplayName}}
        [Display(Name="{{DisplayName}}")]
    {{/ifval}}
        public {{{PrivateType}}} {{PropertyName}} { get => {{PropertyPrivateName}}; set => SetValue(ref {{PropertyPrivateName}}, value{{#if Immutable}}, immutable: true{{/if}}); }
    {{#unless SerializationIgnore}}
      {{#unless RefDataList}}
        {{#if RefDataText}}

        /// <summary>
        /// {{{SummaryRefDataText}}}
        /// </summary>
        {{#ifval JsonName}}
          {{#ifeq Root.JsonSerializer 'Newtonsoft'}}
        [JsonProperty("{{JsonName}}Text")]
          {{else}}
        [JsonPropertyName("{{JsonName}}Text")]
          {{/ifeq}}
        {{/ifval}}
        public string? {{Name}}Text => {{{Type}}}.GetRefDataText({{PropertyPrivateName}});
        {{/if}}
      {{/unless}}
    {{/unless}}

        /// <summary>
        /// {{{SummaryText}}}
        /// </summary>
        [DebuggerBrowsable(DebuggerBrowsableState.Never)]
    {{#ifval DisplayName}}
        [Display(Name="{{DisplayName}}")]
    {{/ifval}}
    {{#ifval Annotation1}}
        {{Annotation1}}
    {{/ifval}}
    {{#ifval Annotation2}}
        {{Annotation2}}
    {{/ifval}}
    {{#ifval Annotation3}}
        {{Annotation3}}
    {{/ifval}}
    {{#if RefDataList}}
        public ReferenceDataCodeList<{{{Type}}}>? {{Name}} { get => new ReferenceDataCodeList<{{{Type}}}>(ref {{PropertyPrivateName}}); set => SetValue(ref {{PropertyPrivateName}}, value?.ToCodeList(){{#if Immutable}}, immutable = true{{/if}}); }
    {{else}}
        public {{{PropertyType}}} {{Name}} { get => {{PropertyPrivateName}}; set => SetValue(ref {{PropertyPrivateName}}, value{{#if Immutable}}, immutable = true{{/if}}); }
    {{/if}}
  {{else}}

        /// <summary>
        /// {{{SummaryText}}}
        /// </summary>
    {{#if SerializationIgnore}}
        [JsonIgnore]
    {{else}}
      {{#ifval JsonName}}
        {{#ifeq Root.JsonSerializer 'Newtonsoft'}}
        [JsonProperty("{{JsonName}}")]
        {{else}}
        [JsonPropertyName("{{JsonName}}")]
        {{/ifeq}}
      {{/ifval}}
    {{/if}}
    {{#ifval DisplayName}}
        [Display(Name="{{DisplayName}}")]
    {{/ifval}}
    {{#ifval WebApiQueryStringConverter}}
        [Beef.WebApi.WebApiArgFormatter(typeof({{WebApiQueryStringConverter}}))]
    {{/ifval}}
    {{#ifval Annotation1}}
        {{Annotation1}}
    {{/ifval}}
    {{#ifval Annotation2}}
        {{Annotation2}}
    {{/ifval}}
    {{#ifval Annotation3}}
        {{Annotation3}}
    {{/ifval}}
    {{#if RefDataMapping}}
        public {{{PropertyType}}} {{Name}}
        {
            get => GetMapping<{{{PropertyType}}}>(nameof({{Name}}));
            set { var _{{PropertyPrivateName}} = {{Name}}; SetValue(ref _{{PropertyPrivateName}}, value); SetMapping(nameof({{Name}}), _{{PropertyPrivateName}}!); }
        }
    {{else}}
        public {{{PropertyType}}} {{Name}} { get => {{#if AutoCreate}}GetAutoValue(ref {{/if}}{{PropertyPrivateName}}{{#if AutoCreate}}){{/if}}; set => SetValue(ref {{PropertyPrivateName}}, value{{#if Immutable}}, immutable: true}}{{/if}}{{#ifeq Type 'string'}}{{#ifne StringTrim 'UseDefault'}}, trim: StringTrim.{{StringTrim}}{{/ifne}}{{#ifne StringTransform 'UseDefault'}}, transform: StringTransform.{{StringTransform}}{{/ifne}}{{/ifeq}}{{#ifeq Type 'DateTime'}}{{#ifne DateTimeTransform 'UseDefault'}}, transform: DateTimeTransform.{{DateTimeTransform}}{{/ifne}}{{/ifeq}}); }
    {{/if}}
  {{/ifval}}
{{/each}}
{{! ===== PrimaryKey ===== }}
{{#unless HasIdentifier}}
  {{#unless RefDataType}}
    {{#ifne UniqueKeyProperties.Count 0}}

        /// <summary>
        /// Creates the primary <see cref="CompositeKey"/>.
        /// </summary>
        /// <returns>The <see cref="CompositeKey"/>.</returns>
    {{#each UniqueKeyProperties}}
        /// <param name="{{ArgumentName}}">The {{{PropertyNameSeeComments}}}.</param>
    {{/each}}
        public static CompositeKey CreatePrimaryKey({{#each UniqueKeyProperties}}{{#unless @first}}, {{/unless}}{{{PrivateType}}} {{PropertyArgumentName}}{{/each}}) => new CompositeKey({{#each UniqueKeyProperties}}{{#unless @first}}, {{/unless}}{{PropertyArgumentName}}{{/each}});

        /// <summary>
        /// Gets the primary <see cref="CompositeKey"/> (consists of the following property(s): {{#each UniqueKeyProperties}}{{#unless @first}}, {{/unless}}{{{PropertyNameSeeComments}}}{{/each}}).
        /// </summary>
        public CompositeKey PrimaryKey => CreatePrimaryKey({{#each UniqueKeyProperties}}{{#unless @first}}, {{/unless}}{{PropertyName}}{{/each}});
    {{/ifne}}
  {{/unless}}
{{/unless}}
{{! ===== PartitionKey ===== }}
{{#unless RefDataType}}
  {{#ifne PartitionKeyProperties.Count 0}}

        /// <summary>
        /// Creates the <see cref="IPartitionKey.PartitionKey"/>.
        /// </summary>
        /// <returns>The Partition Key.</returns>
  {{#each PartitionKeyProperties}}
        /// <param name="{{ArgumentName}}">The {{{PropertyNameSeeComments}}}.</param>
  {{/each}}
        public static string CreatePartitionKey({{#each PartitionKeyProperties}}{{#unless @first}}, {{/unless}}{{{PrivateType}}} {{PropertyArgumentName}}{{/each}}) => PartitionKeyGenerator.Generate({{#each PartitionKeyProperties}}{{#unless @first}}, {{/unless}}{{PropertyArgumentName}}{{/each}});

        /// <summary>
        /// Gets the Partition Key (consists of the following property(s): {{#each PartitionKeyProperties}}{{#unless @first}}, {{/unless}}{{{PropertyNameSeeComments}}}{{/each}}).
        /// </summary>
        public string PartitionKey => CreatePartitionKey({{#each PartitionKeyProperties}}{{#unless @first}}, {{/unless}}{{PropertyName}}{{/each}});
  {{/ifne}}
{{/unless}}
{{! ===== GetPropertyValues ===== }}
{{#ifne CoreProperties.Count 0}}

        /// <inheritdoc/>
        protected override IEnumerable<IPropertyValue> GetPropertyValues()
        {
  {{#if ExtendedInherits}}
            foreach (var pv in base.GetPropertyValues())
                yield return pv;

  {{/if}}
  {{#each CoreProperties}}
            yield return CreateProperty({{PropertyName}}, v => {{PropertyName}} = v);
  {{/each}}
        }
{{/ifne}}
{{! ===== Operator ===== }}
{{#ifval RefDataType}}
  {{#unless Abstract}}

        /// <summary>
        /// An implicit cast from a <see cref="IReferenceData.Code"> to a {{{EntityNameSeeComments}}}.
        /// </summary>
        /// <param name="code">The <b>Code</b>.</param>
        /// <returns>The corresponding {{{EntityNameSeeComments}}}.</returns>
        public static implicit operator {{{EntityName}}}?(string? code) => ConvertFromCode(code);
  {{/unless}}
{{/ifval}}
{{! ===== RefData ===== }}
{{#ifval RefDataType}}
  {{#ifval RefDataStringFormat}}

        /// <summary>
        /// Overrides the default <see cref="ReferenceDataBase.StringFormat"/>.
        /// </summary>
        /// <remarks>The format value is '{{{RefDataStringFormat}}}'.</remarks>
        public override string StringFormat => "{{RefDataStringFormat}}";
  {{/ifval}}
{{/ifval}}
{{! ===== ExtendedInherits ===== }}
{{#if ExtendedInherits}}

        /// <inheritdoc/>
        public bool Equals({{Name}}? other) => base.Equals(other);

        /// <summary>
        /// Compares two values for equality.
        /// </summary>
        /// <param name="a"><see cref="{{Name}}"/> A.</param>
        /// <param name="b"><see cref="{{Name}}"/> B.</param>
        /// <returns><c>true</c> indicates equal; otherwise, <c>false</c> for not equal.</returns>
        public static bool operator ==({{Name}}? a, {{Name}}? b) => Equals(a, b);
    
        /// <summary>
        /// Compares two values for non-equality.
        /// </summary>
        /// <param name="a"><see cref="{{Name}}"/> A.</param>
        /// <param name="b"><see cref="{{Name}}"/> B.</param>
        /// <returns><c>true</c> indicates not equal; otherwise, <c>false</c> for equal.</returns>
        public static bool operator !=({{Name}}? a, {{Name}}? b) => !Equals(a, b);
 
        /// <inheritdoc/>
        public override int GetHashCode() => base.GetHashCode();

        /// <inheritdoc/>
        public override object Clone() => CreateClone<{{Name}}>(this);
{{/if}}
    }
{{! ===== Collection ===== }}
{{#if Collection}}

    /// <summary>
    /// Represents the {{{EntityNameSeeComments}}} collection.
    /// </summary>
    public partial class {{{EntityCollectionName}}} : {{{EntityCollectionInherits}}}
    {
        /// <summary>
        /// Initializes a new instance of the {{{see-comments EntityCollectionName}}} class.
        /// </summary>
        public {{{EntityCollectionName}}}(){{#ifne RefDataSortOrder 'SortOrder'}} : base(ReferenceDataSortOrder.{{RefDataSortOrder}}){{/ifne}} { }

        /// <summary>
        /// Initializes a new instance of the {{{see-comments EntityCollectionName}}} class with a <paramref name="collection"/> of items to add.
        /// </summary>
        /// <param name="collection">A collection containing items to add.</param>
        public {{{EntityCollectionName}}}(IEnumerable<{{{EntityName}}}> collection){{#ifne RefDataSortOrder 'SortOrder'}} : this(){{/ifne}} => AddRange(collection);
    }
{{/if}}
{{! ===== CollectionResult ===== }}
{{#if CollectionResult}}

    /// <summary>
    /// Represents the {{{EntityNameSeeComments}}} collection result.
    /// </summary>
    public class {{{EntityCollectionResultName}}} : {{{EntityCollectionResultInherits}}}
    {
        /// <summary>
        /// Initializes a new instance of the {{{see-comments EntityCollectionResultName}}} class.
        /// </summary>
        public {{{EntityCollectionResultName}}}() { }
        
        /// <summary>
        /// Initializes a new instance of the {{{see-comments EntityCollectionResultName}}} class with <paramref name="paging"/>.
        /// </summary>
        /// <param name="paging">The <see cref="PagingArgs"/>.</param>
        public {{{EntityCollectionResultName}}}(PagingArgs? paging) : base(paging) { }
        
        /// <summary>
        /// Initializes a new instance of the {{{see-comments EntityCollectionResultName}}} class with a <paramref name="collection"/> of items to add.
        /// </summary>
        /// <param name="collection">A collection containing items to add.</param>
        /// <param name="paging">The optional <see cref="PagingArgs"/>.</param>
        public {{{EntityCollectionResultName}}}(IEnumerable<{{{EntityName}}}> collection, PagingArgs? paging = null) : base(paging) => Collection.AddRange(collection);
    }
{{/if}}
}

#pragma warning restore
#nullable restore